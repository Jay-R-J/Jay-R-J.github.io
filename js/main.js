document.addEventListener("DOMContentLoaded",()=>{let e,t,n=!1,a=n=>{var a=e=>Array.from(e).reduce((e,t)=>e+t.offsetWidth,0);n&&(n=a(document.querySelector("#blog-info > a").children),a=a(document.getElementById("menus").children),e=n+a,t=document.getElementById("nav")),n=window.innerWidth<=768||e>t.offsetWidth-120;t.classList.toggle("hide-menu",n)},i=()=>{btf.overflowPaddingR.add(),btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),n=!0},o=()=>{btf.overflowPaddingR.remove(),btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),n=!1},s=async e=>{try{return await(await fetch(e)).json()}catch(e){return[]}},l=(e,t,n)=>{let{isButton:a,limit:i,firstLimit:o,tabs:s}=n;n=t.length;let l=Math.ceil((n-o)/i+1),r=new InfiniteGrid.JustifiedInfiniteGrid(e,{gap:5,isConstantSize:!0,sizeRange:[150,600],useTransform:!0}),d=!1,c=e=>e&&e.replace(/"/g,"&quot;")||"",g=e=>{var t=e.alt?`alt="${c(e.alt)}"`:"",n=e.title?`title="${c(e.title)}"`:"";return`<div class="item">\n        <img src="${e.url}" data-grid-maintained-target="true" ${t} ${n} />\n      </div>`},m=(e,n,a)=>{r.append(((e,n,a=!1)=>(a=a?(e-1)*n:(e-2)*n+o,t.slice(a,a+n).map(g)))(e,n,a),e)},u=t=>{s&&(n=e.parentNode,d&&(n.style.visibility="visible"),0===e.offsetHeight)&&(n.style.visibility="hidden",d=!0);var{updated:n,isResize:t,mounted:o}=t;n.length&&o.length&&!t&&(btf.loadLightbox(e.querySelectorAll("img:not(.medium-zoom-image)")),r.getGroups().length===l?(btf.setLoading.remove(e),s||r.off("renderComplete",u)):a&&(btf.setLoading.remove(e),(e=>{let t=document.createElement("button");t.innerHTML=GLOBAL_CONFIG.infinitegrid.buttonText+'<i class="fa-solid fa-arrow-down"></i>',t.addEventListener("click",()=>{t.remove(),btf.setLoading.add(e),m(r.getGroups().length+1,i)},{once:!0}),e.insertAdjacentElement("afterend",t)})(e)))},f=btf.debounce(e=>{1===(e=(+e.groupKey||0)+1)?m(e,o,!0):m(e,i),e===l&&r.off("requestAppend",f)},300);btf.setLoading.add(e),r.on("renderComplete",u),a?m(1,o,!0):(r.on("requestAppend",f),r.renderItems()),btf.addGlobalFn("pjaxSendOnce",()=>r.destroy())},r=async(e,t=!1)=>{var n;e.length&&(n=async()=>{for(var n of e)if(!btf.isHidden(n)&&!n.classList.contains("loaded")){var a={isButton:"true"===n.getAttribute("data-button"),limit:parseInt(n.getAttribute("data-limit"),10),firstLimit:parseInt(n.getAttribute("data-first"),10),tabs:t},i=n.firstElementChild,o=i.textContent;i.textContent="",n.classList.add("loaded");try{var r="url"===n.getAttribute("data-type")?await s(o):JSON.parse(o);l(i,r,a)}catch(n){}}},"function"!=typeof InfiniteGrid&&await btf.getScript(GLOBAL_CONFIG.infinitegrid.js),await n())},d=()=>{let e=document.getElementById("rightside"),t=window.innerHeight+56,n=0,a=document.getElementById("page-header"),i="undefined"!=typeof chatBtn,o=GLOBAL_CONFIG.percent.rightside,s=()=>document.body.scrollHeight<=t&&(e.classList.add("rightside-show"),!0);if(!s()){let t="";var l=btf.throttle(()=>{var l,r=window.scrollY||document.documentElement.scrollTop,d=(l=(d=r)>n,n=d,l);56<r?(""===t&&(a.classList.add("nav-fixed"),e.classList.add("rightside-show")),d?"down"!==t&&(a.classList.remove("nav-visible"),i&&window.chatBtn.hide(),t="down"):"up"!==t&&(a.classList.add("nav-visible"),i&&window.chatBtn.show(),t="up")):(t="",0===r&&a.classList.remove("nav-fixed","nav-visible"),e.classList.remove("rightside-show")),o&&(e=>{e=btf.getScrollPercent(e,document.body);var t=document.getElementById("go-up");e<95?(t.classList.add("show-percent"),t.querySelector(".scroll-percent").textContent=e):t.classList.remove("show-percent")})(r),s()},300);btf.addEventListenerPjax(window,"scroll",l,{passive:!0})}},c=e=>{let t=(window.globalFn||{}).themeChange||{};t&&Object.keys(t).forEach(n=>{let a=t[n];["disqus","disqusjs"].includes(n)?setTimeout(()=>a(e),300):a(e)})},g={readmode:()=>{let e=document.body,t=document.createElement("button"),n=()=>{e.classList.remove("read-mode"),t.remove(),t.removeEventListener("click",n)};e.classList.add("read-mode"),t.type="button",t.className="fas fa-sign-out-alt exit-readmode",t.addEventListener("click",n),e.appendChild(t)},darkmode:()=>{var e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";"dark"==e?(btf.activateDarkMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(btf.activateLightMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),btf.saveToLocal.set("theme",e,2),c(e)},"rightside-config":e=>{let t=e.firstElementChild;t.classList.contains("show")&&(t.classList.add("status"),setTimeout(()=>{t.classList.remove("status")},300)),t.classList.toggle("show")},"go-up":()=>{btf.scrollToDest(0,500)},"hide-aside-btn":()=>{var e=document.documentElement.classList,t=e.contains("hide-aside")?"show":"hide";btf.saveToLocal.set("aside-status",t,2),e.toggle("hide-aside")},"mobile-toc-button":(e,t)=>{let n=document.getElementById("card-toc");n.style.transition="transform 0.3s ease-in-out";var a=n.clientHeight,i=(t=t.getBoundingClientRect(),window.innerHeight-t.bottom-30);i<a&&(n.style.transformOrigin=`right ${a-i-t.height/2}px`),n.classList.toggle("open"),n.addEventListener("transitionend",()=>{n.style.cssText=""},{once:!0})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}},m=(document.getElementById("rightside").addEventListener("click",e=>{var t=e.target.closest("[id]");t&&g[t.id]&&g[t.id](e.currentTarget,t)}),()=>{var e=document.querySelectorAll("#article-container table");e.length&&e.forEach(e=>{e.closest(".highlight")||btf.wrap(e,"div",{class:"table-wrap"})})}),u=e=>{e.forEach(e=>{e.textContent=btf.diffDate(e.getAttribute("datetime"),!0),e.style.display="inline"})},f=()=>{(()=>{var e=GLOBAL_CONFIG.highlight;if(e){let{highlightCopy:n,highlightLang:a,highlightHeightLimit:i,highlightFullpage:o,highlightMacStyle:s,plugin:l}=e;e=GLOBAL_CONFIG_SITE.isHighlightShrink;let r=n||a||void 0!==e||o||s;var t="highlight.js"===l?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if((r||i)&&t.length){let s="prismjs"===l,d=!0===e?"closed":"",c=void 0!==e?'<i class="fas fa-angle-down expand"></i>':"",g=n?'<i class="fas fa-paste copy-button"></i>':"",m=o?'<i class="fa-solid fa-up-right-and-down-left-from-center fullpage-button"></i>':"",u=(e,t)=>{if(void 0!==GLOBAL_CONFIG.Snackbar)btf.snackbarShow(t);else{let i=document.createElement("div");i.className="copy-notice",i.textContent=t,document.body.appendChild(i),t=e.getBoundingClientRect();var n=window.pageYOffset||document.documentElement.scrollTop,a=window.pageXOffset||document.documentElement.scrollLeft;n=t.top+n-40,a=t.left+a+t.width/2;let o=e.closest("figure.highlight").classList.contains("code-fullpage")?60+n:n;i.style.cssText=`\n      top: ${10+o}px;\n      left: ${a}px;\n      transform: translateX(-50%);\n      opacity: 0;\n      transition: opacity 0.3s ease, top 0.3s ease;\n    `,requestAnimationFrame(()=>{i.style.opacity="1",i.style.top=o+"px"}),setTimeout(()=>{i.style.opacity="0",i.style.top=10+o+"px",setTimeout(()=>{i?.remove()},300)},800)}},f=async(e,t)=>{try{await navigator.clipboard.writeText(e),u(t,GLOBAL_CONFIG.copy.success)}catch(e){u(t,GLOBAL_CONFIG.copy.noSupport)}},h=(e,t)=>{var n=((e=e.parentNode).classList.add("copy-true"),s?"pre code":"table .code pre");(n=e.querySelector(n))&&(f(n.innerText,t),e.classList.remove("copy-true"))},p=e=>e.classList.toggle("closed"),L=(e,t)=>{e=e.closest("figure.highlight").classList.toggle("code-fullpage"),document.body.style.overflow=e?"hidden":"",t.classList.toggle("fa-down-left-and-up-right-to-center",e),t.classList.toggle("fa-up-right-and-down-left-from-center",!e)},b=e=>{var t=e.target.classList,n=e.currentTarget;t.contains("expand")?p(n):t.contains("copy-button")?h(n,e.target):t.contains("fullpage-button")&&L(n,e.target)},v=e=>e.currentTarget.classList.toggle("expand-done"),y=(e,t)=>{var n,a=document.createDocumentFragment();r&&((n=document.createElement("div")).className="highlight-tools "+d,n.innerHTML='<div class="macStyle"><div class="mac-close"></div><div class="mac-minimize"></div><div class="mac-maximize"></div></div>'+c+e+g+m,btf.addEventListenerPjax(n,"click",b),a.appendChild(n)),i&&(e=>{let t=new Map;(()=>{let n=e;for(;n!==document.body&&null!=n;)"none"===window.getComputedStyle(n).display&&t.set(n,n.getAttribute("style")||""),n=n.parentNode;let a="visibility: hidden !important; display: block !important;";t.forEach((e,t)=>{t.setAttribute("style",e?e+";"+a:a)})})();var n=e.offsetHeight;return t.forEach((e,t)=>{""===e?t.removeAttribute("style"):t.setAttribute("style",e)}),n})(t)>i+30&&((e=document.createElement("div")).className="code-expand-btn",e.innerHTML='<i class="fas fa-angle-double-down"></i>',btf.addEventListenerPjax(e,"click",v),a.appendChild(e)),s?t.parentNode.insertBefore(a,t):t.insertBefore(a,t.firstChild)};t.forEach(e=>{let t="";s&&btf.wrap(e,"figure",{class:"highlight"}),a?(s?t=e.getAttribute("data-language")||"Code":"plain"!==(t=e.getAttribute("class").split(" ")[1])&&void 0!==t||(t="Code"),y(`<div class="code-lang">${t}</div>`,e)):y("",e)})}}})(),GLOBAL_CONFIG.isPhotoFigcaption&&document.querySelectorAll("#article-container img").forEach(e=>{var t,n=e.title||e.alt;n&&((t=document.createElement("div")).className="img-alt text-center",t.textContent=n,e.insertAdjacentElement("afterend",t))}),r(document.querySelectorAll("#article-container .gallery-container")),btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)")),(()=>{let e=GLOBAL_CONFIG_SITE.isToc,t=GLOBAL_CONFIG.isAnchor,n=document.getElementById("article-container");if(n&&(e||t)){let i,o,s,l,r;if(e){let e=document.getElementById("card-toc");o=e.querySelector(".toc-content"),i=o.querySelectorAll(".toc-link"),l=e.querySelector(".toc-percentage"),r=o.classList.contains("is-expand"),btf.addEventListenerPjax(o,"click",t=>{var n=t.target.closest(".toc-link");n&&(t.preventDefault(),btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI(n.getAttribute("href")).replace("#",""))),300),window.innerWidth<900)&&e.classList.remove("open")}),s=e=>{var t=o.clientHeight,n=e.offsetTop,a=(e=e.clientHeight,o.scrollTop);(n-=a)!=(t=(t-e)/2)&&(o.scrollTop=a+(n-t))},o.style.display="block"}let d=n.querySelectorAll("h1,h2,h3,h4,h5,h6"),c="";var a=btf.throttle(()=>{var a=window.scrollY||document.documentElement.scrollTop;e&&GLOBAL_CONFIG.percent.toc&&(l.textContent=btf.getScrollPercent(a,n));var g=a;if(0!==g){let n="",a="";for(let e=0;e<d.length;e++){var m=d[e];if(!(g>btf.getEleTop(m)-80))break;n=(m=m.id)?"#"+encodeURI(m):"",a=e}if(c!==a&&(t&&btf.updateAnchor(n),c=a,e)&&(o.querySelectorAll(".active").forEach(e=>e.classList.remove("active")),n)){let e=i[a];if(e.classList.add("active"),setTimeout(()=>s(e),0),!r){let t=e.parentNode;for(;!t.matches(".toc");)t.matches("li")&&t.classList.add("active"),t=t.parentNode}}}},100);btf.addEventListenerPjax(window,"scroll",a,{passive:!0})}})(),m(),(()=>{var e=document.querySelectorAll("#article-container .hide-button");e.length&&e.forEach(e=>e.addEventListener("click",e=>{(e=e.currentTarget).classList.add("open"),r(e.nextElementSibling.querySelectorAll(".gallery-container"))},{once:!0}))})(),(()=>{var e=document.querySelectorAll("#article-container .tabs");if(e.length){let t=(e,t)=>{e.forEach((e,n)=>{e.classList.toggle("active",n===t)})},n=e=>{var n,a,i=e.target.closest("button");i&&!i.classList.contains("active")&&(n=[...e.currentTarget.children],a=[...e.currentTarget.nextElementSibling.children],i=n.indexOf(i),t(n,i),e.currentTarget.classList.remove("no-default"),t(a,i),r(a[i].querySelectorAll(".gallery-container"),!0))};e.forEach(e=>{var t;btf.addEventListenerPjax(e.firstElementChild,"click",n),btf.addEventListenerPjax(e.lastElementChild,"click",(t=e,e=>{e.target.closest("button")&&btf.scrollToDest(btf.getEleTop(t),300)}))})}})()};var h=()=>{var e,n,o,s,l;a(!0),t.classList.add("show"),(l=document.getElementById("recent-posts"))&&l.classList.contains("masonry")&&(l=()=>{let e=new InfiniteGrid.MasonryInfiniteGrid(".recent-post-items",{gap:{horizontal:10,vertical:20},useTransform:!0,useResizeObserver:!0});e.renderItems(),btf.addGlobalFn("pjaxCompleteOnce",()=>{e.destroy()},"removeJustifiedIndexPostUI")},"function"==typeof InfiniteGrid?l():btf.getScript(""+GLOBAL_CONFIG.infinitegrid.js).then(l)),"post"===GLOBAL_CONFIG_SITE.pageType?((l=document.getElementById("post-outdate-notice"))&&(({limitDay:s,messagePrev:e,messageNext:n,postUpdate:o}=JSON.parse(l.getAttribute("data"))),s<=(s=btf.diffDate(o)))&&(l.textContent=e+` ${s} `+n,l.hidden=!1),GLOBAL_CONFIG.relativeDate.post&&u(document.querySelectorAll("#post-meta time"))):(GLOBAL_CONFIG.relativeDate.homepage&&u(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&(o=document.getElementById("runtimeshow"))&&(e=o.getAttribute("data-publishDate"),o.textContent=btf.diffDate(e)+" "+GLOBAL_CONFIG.runtime),(s=document.getElementById("last-push-date"))&&(n=s.getAttribute("data-lastPushDate"),s.textContent=btf.diffDate(n,!0)),(l=document.querySelector("#aside-cat-list.expandBtn"))&&btf.addEventListenerPjax(l,"click",e=>{var t=e.target;"I"===t.nodeName&&(e.preventDefault(),t.parentNode.classList.toggle("expand"))},!0)),"home"===GLOBAL_CONFIG_SITE.pageType&&(l=document.getElementById("scroll-down"))&&btf.addEventListenerPjax(l,"click",()=>{btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)}),d(),f(),"shuoshuo"!==GLOBAL_CONFIG_SITE.pageType&&btf.switchComments(document),(l=document.getElementById("toggle-menu"))&&btf.addEventListenerPjax(l,"click",()=>{i()})};btf.addGlobalFn("pjaxComplete",h,"refreshFn"),h(),window.addEventListener("resize",()=>{a(!1),n&&btf.isHidden(document.getElementById("toggle-menu"))&&o()}),(h=document.getElementById("menu-mask"))&&h.addEventListener("click",()=>{o()}),(h=document.querySelector("#sidebar-menus .menus_items"))&&h.addEventListener("click",e=>{(e=e.target.closest(".site-page.group"))&&e.classList.toggle("hide")}),GLOBAL_CONFIG.islazyloadPlugin&&(window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"}),btf.addGlobalFn("pjaxComplete",()=>{window.lazyLoadInstance.update()},"lazyload")),void 0!==GLOBAL_CONFIG.copyright&&(()=>{let{limitCount:e,languages:t}=GLOBAL_CONFIG.copyright;document.body.addEventListener("copy",n=>{n.preventDefault();var a=window.getSelection(0).toString();let i=a;return a.length>e&&(i=`${a}\n\n\n${t.author}\n${t.link}${window.location.href}\n${t.source}\n`+t.info),(n.clipboardData?n:window).clipboardData.setData("text",i)})})(),GLOBAL_CONFIG.autoDarkmode&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{void 0===btf.saveToLocal.get("theme")&&(e.matches?c("dark"):c("light"))}),window.addEventListener("hexo-blog-decrypt",e=>{f(),window.translateFn.translateInitialization(),Object.values(window.globalFn.encrypt).forEach(e=>{e()})})});